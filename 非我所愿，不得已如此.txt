- 后端的更新推送可能有问题。如果实在不行的话，改为后端通知前端有新的【最近消息】可用，从而让前端拉取最新更新。（放弃增量更新）
- 所有会参与的新消息都应该通知前端更新完整的【最近消息】
- 可以尝试通过wireshark来度量实际上的传输量


ChatHub重构

服务器端事件：
	PatchMessage：向所有组内用户发送一个消息对象，用于更新一条已有消息的内容和状态。会因来自客户端的事件UpdateMessage触发。
	UpdateRecents：向所有不在组内但是订阅了消息更新（持有对应有效Contact的用户）在订阅的聊天发生更新的时候，通知客户端拉取新的最近消息
	IncomeMessage: 向所有组内用户发送一个消息对象，用于推送一条新消息。这条消息来自客户端触发的事件SendMessage（或SendMessageAsUser，但是这个方法不鉴权）

客户端事件：
	JoinChat: 加入一个聊天组以实时获取IncomeMessage和PatchMessage
	LeaveChat：在Hub发现断开网络连接或在客户端上退出聊天界面的时候调用，用于停止获取IncomeMessage和PatchMessage
	SendMessage：任何时候都可使用，用于向服务端发送一条消息。服务端根据聊天参与者（所有订阅此聊天的人）是否加入对应聊天组来决定使用IncomeMessage还是UpdateRecents
	UpdateMessage：任何时候都可使用，用于向服务端发送一条已有的消息。此事件仅允许更新isCanceled为false的消息，更新isCanceled为true或更改其isAnnouncement为true/false。服务端根据聊天参与者（所有订阅此聊天的人）是否加入对应聊天组来决定使用IncomeMessage还是UpdateRecents

必须保证满足以下要求：
	无论通过哪种方法接收新消息，必然能通过一个方法判断并最终调用符合上述要求的正确的方法推送
	修改现有方法，并且保留系统内部调用的SendAsUser方法（ChatAgent中**似乎**有可以用上的工具方法）	
	
client：(will send)
	JoinChat
	LeaveChat
	SendMessage
	UpdateMessage
	
server：(will send)
	PatchMessage
	UpdateRecents
	IncomeMessage
	
general call：
	OnConnect -> Subscribe
	OnDisconnect -> Unsubscribe
	
	
